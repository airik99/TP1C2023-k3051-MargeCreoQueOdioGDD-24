USE GD1C2023
GO

/* --------------------------------------------- Creacion de tablas dimensionales --------------------------------------------- */

CREATE TABLE MargeCreoQueOdioGDD.BI_Tiempo (
	ID_TIEMPO INT IDENTITY(1,1),
	ANIO INT NOT NULL,
	MES INT NOT NULL,
	PRIMARY KEY (ID_TIEMPO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Dia (
	ID_DIA INT IDENTITY(1,1),
	DIA NVARCHAR(50) NOT NULL,
	PRIMARY KEY (ID_DIA)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Rango_Horario (
	ID_RANGO_HORARIO INT IDENTITY(1,1),
	HORA_INICIO INT NOT NULL,
	HORA_FIN INT NOT NULL,
	PRIMARY KEY (ID_RANGO_HORARIO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Provincia (
	ID_PROVINCIA INT IDENTITY(1,1),
	PROVINCIA NVARCHAR(255) NOT NULL,
	PRIMARY KEY (ID_PROVINCIA)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Localidad (
	ID_LOCALIDAD INT IDENTITY(1,1),
	LOCALIDAD NVARCHAR(255) NOT NULL,
	ID_PROVINCIA INT NOT NULL, -- FK
	PRIMARY KEY (ID_LOCALIDAD)
);

/*
CREATE TABLE MargeCreoQueOdioGDD.BI_Direccion (
	ID_DIRECCION INT IDENTITY(1,1),
	DIRECCION NVARCHAR(255) NOT NULL,
	ID_LOCALIDAD INT NOT NULL, -- FK
	PRIMARY KEY (ID_DIRECCION)
);
*/

CREATE TABLE MargeCreoQueOdioGDD.BI_Rango_Etario (
	ID_RANGO_ETARIO INT IDENTITY(1,1),
	EDAD_INICIAL INT NOT NULL,
	EDAD_FINAL INT NOT NULL,
	PRIMARY KEY (ID_RANGO_ETARIO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Tipo_Medio_Pago (
	ID_TIPO_PAGO INT IDENTITY(1,1),
	MEDIO_PAGO NVARCHAR(255) NOT NULL,
	PRIMARY KEY (ID_TIPO_PAGO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Tipo_Local ( /* Creo que si bien lo dice el enunciado, no lo usamos */
	ID_TIPO_LOCAL INT IDENTITY(1,1),
	TIPO_LOCAL NVARCHAR(255),
	PRIMARY KEY (ID_TIPO_LOCAL)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Categoria_Local (
	ID_CATEGORIA_LOCAL INT IDENTITY(1,1),
	CATEGORIA NVARCHAR(255),
	ID_TIPO_LOCAL INT NOT NULL, -- FK
	PRIMARY KEY (ID_CATEGORIA_LOCAL)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Local (
	ID_LOCAL INT IDENTITY(1,1),
	NOMBRE NVARCHAR(255),
	DESCRIPCION NVARCHAR(255),
	ID_CATEGORIA INT, -- FK
	ID_LOCALIDAD INT, -- FK
	PRIMARY KEY (ID_LOCAL)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Tipo_Movilidad (
	ID_TIPO_MOVILIDAD INT IDENTITY(1,1),
	TIPO_MOVILIDAD NVARCHAR(255),
	PRIMARY KEY (ID_TIPO_MOVILIDAD)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Repartidor (
	ID_REPARTIDOR INT IDENTITY(1,1),
	ID_RANGO_ETARIO INT NOT NULL, -- FK
	ID_TIPO_MOVILIDAD INT NOT NULL, --FK
	PRIMARY KEY (ID_REPARTIDOR)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Usuario (
	ID_USUARIO INT IDENTITY(1,1),
	ID_RANGO_ETARIO INT NOT NULL, -- FK
	FECHA_NACIMIENTO DATE,
	PRIMARY KEY (ID_USUARIO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Operador (
	ID_OPERADOR INT IDENTITY(1,1), --PK
	ID_RANGO_ETARIO INT NOT NULL, -- FK
	PRIMARY KEY (ID_OPERADOR)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Tipo_Paquete (
	ID_TIPO_PAQUETE INT IDENTITY(1,1),
	TIPO_PAQUETE NVARCHAR(255),
	VALOR_ASEGURADO FLOAT,
	PRIMARY KEY (ID_TIPO_PAQUETE)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Estado_Pedido (
	ID_ESTADO_PEDIDO INT IDENTITY(1,1),
	ESTADO NVARCHAR(255),
	PRIMARY KEY (ID_ESTADO_PEDIDO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Estado_Mensajeria (
	ID_ESTADO_MENSAJERIA INT IDENTITY(1,1),
	ESTADO NVARCHAR(255),
	PRIMARY KEY (ID_ESTADO_MENSAJERIA)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Estado_Reclamo (
	ID_ESTADO_RECLAMO INT IDENTITY(1,1),
	ESTADO NVARCHAR(255),
	PRIMARY KEY (ID_ESTADO_RECLAMO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Envio (
	NRO_ENVIO INT IDENTITY(1,1),
	ID_LOCALIDAD_DESTINO INT NOT NULL, -- FK
	ID_REPARTIDOR INT NOT NULL, -- FK
	PRECIO_ENVIO FLOAT,
	TIEMPO_ESTIMADO_ENTREGA DECIMAL,
	PRIMARY KEY (NRO_ENVIO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Pedido (
	NRO_PEDIDO INT NOT NULL,
	ID_TIEMPO_PEDIDO INT NOT NULL, -- FK
	ID_DIA_PEDIDO INT NOT NULL, -- FK
	ID_RANGO_HORARIO_PEDIDO INT NOT NULL, -- FK
	ID_TIEMPO_ENTREGA INT NOT NULL, -- FK
	ID_DIA_ENTREGA INT NOT NULL, -- FK
	ID_RANGO_HORARIO_ENTREGA INT NOT NULL, -- FK
	ID_LOCAL INT NOT NULL, -- FK
	ID_ENVIO INT NOT NULL, -- FK
	ID_ESTADO INT NOT NULL, -- FK
	ID_USUARIO INT NOT NULL, -- FK
	TARIFA_SERVICIO FLOAT NOT NULL,
	TOTAL_PRODUCTOS FLOAT NOT NULL,
	TOTAL_CUPONES FLOAT NOT NULL,
	TOTAL_SERVICIO FLOAT NOT NULL,
	TOTAL_PEDIDO FLOAT NOT NULL,
	CALIFICACION DECIMAL(5,1),
	ESTADO NVARCHAR(255),
	PRIMARY KEY (NRO_PEDIDO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria (
	NRO_ENVIO_MENSAJERIA INT NOT NULL,
	ID_LOCALIDAD_ORIGEN INT NOT NULL, -- FK
	ID_TIPO_PAQUETE INT NOT NULL, -- FK
	ID_ENVIO INT NOT NULL, -- FK
	ID_ESTADO INT NOT NULL, -- FK
	ID_TIEMPO_PEDIDO INT NOT NULL, -- FK
	ID_DIA_PEDIDO INT NOT NULL, -- FK
	ID_RANGO_HORARIO_PEDIDO INT NOT NULL, -- FK
	ID_TIEMPO_ENTREGA INT NOT NULL, -- FK
	ID_DIA_ENTREGA INT NOT NULL, -- FK
	ID_RANGO_HORARIO_ENTREGA INT NOT NULL, -- FK
	--ID_USUARIO INT NOT NULL, -- FK
	--DISTANCIA_KMS INT NOT NULL,
	--CALIFICACION DECIMAL(5,1),
	--PRECIO_POR_SEGURO FLOAT NOT NULL,
	TOTAL_SERVICIO_MENSAJERIA FLOAT NOT NULL,
	PRIMARY KEY (NRO_ENVIO_MENSAJERIA)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Tipo_Reclamo (
	ID_TIPO_RECLAMO INT IDENTITY(1,1),
	TIPO_RECLAMO NVARCHAR(255),
	PRIMARY KEY (ID_TIPO_RECLAMO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Reclamo (
	NRO_RECLAMO INT NOT NULL,
	--ID_USUARIO INT NOT NULL, -- FK
	--ID_PEDIDO INT NOT NULL, -- FK
	ID_OPERADOR INT NOT NULL, -- FK
	ID_ESTADO INT NOT NULL, -- FK
	ID_TIPO_RECLAMO INT NOT NULL, --FK
	ID_TIEMPO_INICIO INT NOT NULL, -- FK
	ID_DIA_INICIO INT NOT NULL, -- FK
	ID_RANGO_HORARIO_INICIO INT NOT NULL, -- FK
	ID_TIEMPO_SOLUCION INT NOT NULL, -- FK
	ID_DIA_SOLUCION INT NOT NULL, -- FK
	ID_RANGO_HORARIO_SOLUCION INT NOT NULL, -- FK
	--DESCRIPCION NVARCHAR(255),
	--SOLUCION NVARCHAR(255),
	--CALIFICACION DECIMAL(5,1),
	PRIMARY KEY (NRO_RECLAMO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Tipo_Cupon (
	ID_TIPO INT IDENTITY(1,1), --PK
	TIPO_CUPON NVARCHAR(255),
	PRIMARY KEY (ID_TIPO)
);

CREATE TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento (
	CODIGO INT NOT NULL,
	ID_USUARIO INT NOT NULL, -- FK
	ID_TIPO_CUPON INT NOT NULL, -- FK
	ID_TIEMPO_ALTA INT NOT NULL, -- FK
	ID_DIA_ALTA INT NOT NULL, -- FK
	ID_RANGO_HORARIO_ALTA INT NOT NULL, -- FK
	ID_TIEMPO_VENCIMIENTO INT NOT NULL, -- FK
	ID_DIA_VENCIMIENTO INT NOT NULL, -- FK
	ID_RANGO_HORARIO_VENCIMIENTO INT NOT NULL, -- FK
	MONTO FLOAT,
	PRIMARY KEY (CODIGO)
);

/* --------------------------------------------- Alter tables --------------------------------------------- */

-- Localidad
ALTER TABLE MargeCreoQueOdioGDD.BI_Localidad
ADD CONSTRAINT FK_BI_PROVINCIA_ID
FOREIGN KEY (ID_PROVINCIA) REFERENCES MargeCreoQueOdioGDD.BI_Provincia

ALTER TABLE MargeCreoQueOdioGDD.BI_Localidad
ADD CONSTRAINT FK_BI_PROVINCIA_ID
FOREIGN KEY (ID_PROVINCIA) REFERENCES MargeCreoQueOdioGDD.BI_Provincia

/*ALTER TABLE MargeCreoQueOdioGDD.BI_Direccion
ADD CONSTRAINT FK_BI_LOCALIDAD_ID
FOREIGN KEY (ID_LOCALIDAD) REFERENCES MargeCreoQueOdioGDD.BI_Localidad*/

-- Local
ALTER TABLE MargeCreoQueOdioGDD.BI_Categoria_Local
ADD CONSTRAINT FK_BI_TIPO_LOCAL_ID
FOREIGN KEY (ID_TIPO_LOCAL) REFERENCES MargeCreoQueOdioGDD.BI_Tipo_Local

ALTER TABLE MargeCreoQueOdioGDD.BI_Local
ADD CONSTRAINT FK_BI_CATEGORIA_LOCAL_ID
FOREIGN KEY (ID_CATEGORIA_LOCAL) REFERENCES MargeCreoQueOdioGDD.BI_Categoria_Local

ALTER TABLE MargeCreoQueOdioGDD.BI_Local
ADD CONSTRAINT FK_BI_LOCALIDAD_LOCAL_ID
FOREIGN KEY (ID_LOCALIDAD) REFERENCES MargeCreoQueOdioGDD.BI_Localidad

-- Repartidores, Usuarios y Operadores
ALTER TABLE MargeCreoQueOdioGDD.BI_Repartidor
ADD CONSTRAINT FK_BI_TIPO_MOVILIDAD_REPARTIDOR_ID
FOREIGN KEY (ID_TIPO_MOVILIDAD) REFERENCES MargeCreoQueOdioGDD.BI_Tipo_Movilidad

ALTER TABLE MargeCreoQueOdioGDD.BI_Repartidor
ADD CONSTRAINT FK_BI_RANGO_ETARIO_REPARTIDOR_ID
FOREIGN KEY (ID_RANGO_ETARIO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Etario

ALTER TABLE MargeCreoQueOdioGDD.BI_Usuario
ADD CONSTRAINT FK_BI_RANGO_ETARIO_USUARIO_ID
FOREIGN KEY (ID_RANGO_ETARIO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Etario

ALTER TABLE MargeCreoQueOdioGDD.BI_Operador
ADD CONSTRAINT FK_BI_RANGO_ETARIO_OPERADOR_ID
FOREIGN KEY (ID_RANGO_ETARIO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Etario

-- Envio
ALTER TABLE MargeCreoQueOdioGDD.BI_Envio
ADD CONSTRAINT FK_BI_LOCALIDAD_DESTINO_ENVIO_ID
FOREIGN KEY (ID_LOCALIDAD_DESTINO) REFERENCES MargeCreoQueOdioGDD.BI_Localidad

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio
ADD CONSTRAINT FK_BI_REPARTIDOR_ENVIO_ID
FOREIGN KEY (ID_REPARTIDOR) REFERENCES MargeCreoQueOdioGDD.BI_Repartidor

-- Pedido
ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_TIEMPO_PEDIDO_HECHO_ID
FOREIGN KEY (ID_TIEMPO_PEDIDO) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_DIA_PEDIDO_HECHO_ID
FOREIGN KEY (ID_DIA_PEDIDO) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_RANGO_HORARIO_PEDIDO_HECHO_ID
FOREIGN KEY (ID_RANGO_HORARIO_PEDIDO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_TIEMPO_PEDIDO_ENTREGADO_ID
FOREIGN KEY (ID_TIEMPO_ENTREGA) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_DIA_PEDIDO_ENTREGADO_ID
FOREIGN KEY (ID_DIA_ENTREGA) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_RANGO_HORARIO_PEDIDO_ENTREGADO_ID
FOREIGN KEY (ID_RANGO_HORARIO_ENTREGA) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_LOCAL_PEDIDO_ID
FOREIGN KEY (ID_LOCAL) REFERENCES MargeCreoQueOdioGDD.BI_Local

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_ENVIO_PEDIDO_ID
FOREIGN KEY (ID_ENVIO) REFERENCES MargeCreoQueOdioGDD.BI_Envio

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_ESTADO_PEDIDO_ID
FOREIGN KEY (ID_ESTADO) REFERENCES MargeCreoQueOdioGDD.BI_Estado_Pedido

ALTER TABLE MargeCreoQueOdioGDD.BI_Pedido
ADD CONSTRAINT FK_BI_USUARIO_PEDIDO_ID
FOREIGN KEY (ID_USUARIO) REFERENCES MargeCreoQueOdioGDD.BI_Usuario

-- Servicio de mensajeria
ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_LOCALIDAD_ORIGEN_MENSAJERIA_ID
FOREIGN KEY (ID_LOCALIDAD_ORIGEN) REFERENCES MargeCreoQueOdioGDD.BI_Localidad

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_TIPO_PAQUETE_MENSAJERIA_ID
FOREIGN KEY (ID_TIPO_PAQUETE) REFERENCES MargeCreoQueOdioGDD.BI_Tipo_Paquete

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_TIEMPO_MENSAJERIA_HECHA_ID
FOREIGN KEY (ID_TIEMPO_PEDIDO) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_DIA_MENSAJERIA_HECHA_ID
FOREIGN KEY (ID_DIA_PEDIDO) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_RANGO_HORARIO_MENSAJERIA_HECHA_ID
FOREIGN KEY (ID_RANGO_HORARIO_PEDIDO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_TIEMPO_MENSAJERIA_ENTREGADO_ID
FOREIGN KEY (ID_TIEMPO_ENTREGA) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_DIA_MENSAJERIA_ENTREGADO_ID
FOREIGN KEY (ID_DIA_ENTREGA) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_RANGO_HORARIO_MENSAJERIA_ENTREGADO_ID
FOREIGN KEY (ID_RANGO_HORARIO_ENTREGA) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_ENVIO_MENSAJERIA_ID
FOREIGN KEY (ID_ENVIO) REFERENCES MargeCreoQueOdioGDD.BI_Envio

ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_ESTADO_MENSAJERIA_ID
FOREIGN KEY (ID_ESTADO) REFERENCES MargeCreoQueOdioGDD.BI_Estado_Mensajeria

/*ALTER TABLE MargeCreoQueOdioGDD.BI_Envio_Mensajeria
ADD CONSTRAINT FK_BI_USUARIO_MENSAJERIA_ID
FOREIGN KEY (ID_USUARIO) REFERENCES MargeCreoQueOdioGDD.BI_Usuario*/

-- Reclamo
ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_ESTADO_RECLAMO_ID
FOREIGN KEY (ID_ESTADO) REFERENCES MargeCreoQueOdioGDD.BI_Estado_Reclamo

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_TIPO_RECLAMO_ID
FOREIGN KEY (ID_TIPO_RECLAMO) REFERENCES MargeCreoQueOdioGDD.BI_Tipo_Reclamo

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_TIEMPO_RECLAMO_INICIO_ID
FOREIGN KEY (ID_TIEMPO_INICIO) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_DIA_RECLAMO_INICIO_ID
FOREIGN KEY (ID_DIA_INICIO) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_RANGO_HORARIO_RECLAMO_INICIO_ID
FOREIGN KEY (ID_RANGO_HORARIO_INICIO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_TIEMPO_RECLAMO_SOLUCION_ID
FOREIGN KEY (ID_TIEMPO_SOLUCION) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_DIA_RECLAMO_SOLUCION_ID
FOREIGN KEY (ID_DIA_SOLUCION) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_RANGO_HORARIO_RECLAMO_SOLUCION_ID
FOREIGN KEY (ID_RANGO_HORARIO_SOLUCION) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Reclamo
ADD CONSTRAINT FK_BI_OPERADOR_RECLAMO_ID
FOREIGN KEY (ID_OPERADOR) REFERENCES MargeCreoQueOdioGDD.BI_Operador

-- Cupones
ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_TIEMPO_ALTA_ID
FOREIGN KEY (ID_TIEMPO_ALTA) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Tipo_Cupon
ADD CONSTRAINT FK_BI_TIPO_CUPON_ID
FOREIGN KEY (ID_TIPO_CUPON) REFERENCES MargeCreoQueOdioGDD.BI_Tipo_Cupon

ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_DIA_ALTA_ID
FOREIGN KEY (ID_DIA_ALTA) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_RANGO_HORARIO_ALTA_ID
FOREIGN KEY (ID_RANGO_HORARIO_ALTA) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_TIEMPO_CUPON_VENCIMIENTO_ID
FOREIGN KEY (ID_TIEMPO_VENCIMIENTO) REFERENCES MargeCreoQueOdioGDD.BI_Tiempo

ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_DIA_CUPON_VENCIMIENTO_ID
FOREIGN KEY (ID_DIA_VENCIMIENTO) REFERENCES MargeCreoQueOdioGDD.BI_Dia

ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_RANGO_HORARIO_CUPON_VENCIMIENTO_ID
FOREIGN KEY (ID_RANGO_HORARIO_VENCIMIENTO) REFERENCES MargeCreoQueOdioGDD.BI_Rango_Horario

ALTER TABLE MargeCreoQueOdioGDD.BI_Cupon_Descuento
ADD CONSTRAINT FK_BI_USUARIO_CUPON_ID
FOREIGN KEY (ID_USUARIO) REFERENCES MargeCreoQueOdioGDD.BI_Usuario

/* Creacion de procedures para cargar todas las tablas utilizando los datos ya migrados al modelo de datos transaccional */



/* Creacion de vistas */